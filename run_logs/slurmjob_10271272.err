
CondaError: Run 'conda init' before 'conda activate'

2025-04-28 14:19:50,647	WARNING deprecation.py:50 -- DeprecationWarning: `DirectStepOptimizer` has been deprecated. This will raise an error in the future!
/next/u/stephhk/miniconda3/envs/orpo/lib/python3.9/site-packages/flow/utils/flow_warnings.py:23: PendingDeprecationWarning: The attribute minGap in SumoCarFollowingParams is deprecated, use min_gap instead.
  warnings.warn(
2025-04-28 14:19:51,978	WARNING algorithm_config.py:2604 -- config._enable_rl_module_api was set to False, but no prior exploration config was found to be restored.
2025-04-28 14:19:51,978	WARNING algorithm_config.py:672 -- Cannot create AlgorithmConfig from given `config_dict`! Property sgd_minibatch_size not supported.
INFO - root - Saving experiment results to pandemic/ORPO/proxy/model_128-128/weights_10.0_0.1_0.01//seed_0
WARNING - orpo_experiments - No observers have been added to this run
INFO - orpo_experiments - Running command 'main'
INFO - orpo_experiments - Started
2025-04-28 14:19:54,311	INFO worker.py:1642 -- Started a local Ray instance.
2025-04-28 14:19:55,593	WARNING algorithm_config.py:2578 -- Setting `exploration_config={}` because you set `_enable_rl_module_api=True`. When RLModule API are enabled, exploration_config can not be set. If you want to implement custom exploration behaviour, please modify the `forward_exploration` method of the RLModule at hand. On configs that have a default exploration config, this must be done with `config.exploration_config={}`.
2025-04-28 14:19:55,595	WARNING algorithm_config.py:2592 -- Setting `exploration_config={'type': 'StochasticSampling'}` because you set `_enable_rl_module_api=False`. This exploration config was restored from a prior exploration config that was overriden when setting `_enable_rl_module_api=True`. This occurs because when RLModule API are enabled, exploration_config can not be set.
[2m[36m(pid=1305299)[0m DeprecationWarning: `DirectStepOptimizer` has been deprecated. This will raise an error in the future!
[2m[36m(RolloutWorker pid=1305299)[0m 2025-04-28 14:20:01,065	WARNING algorithm_config.py:2578 -- Setting `exploration_config={}` because you set `_enable_rl_module_api=True`. When RLModule API are enabled, exploration_config can not be set. If you want to implement custom exploration behaviour, please modify the `forward_exploration` method of the RLModule at hand. On configs that have a default exploration config, this must be done with `config.exploration_config={}`.
[2m[36m(RolloutWorker pid=1305299)[0m 2025-04-28 14:20:01,068	WARNING deprecation.py:50 -- DeprecationWarning: `ray.rllib.models.torch.torch_modelv2.TorchModelV2` has been deprecated. Use `ray.rllib.core.rl_module.rl_module.RLModule` instead. This will raise an error in the future!
[2m[36m(RolloutWorker pid=1305299)[0m 2025-04-28 14:20:01,068	WARNING deprecation.py:50 -- DeprecationWarning: `ray.rllib.models.torch.fcnet.FullyConnectedNetwork` has been deprecated. This will raise an error in the future!
[2m[36m(RolloutWorker pid=1305299)[0m 2025-04-28 14:20:01,081	WARNING catalog.py:629 -- Custom ModelV2 should accept all custom options as **kwargs, instead of expecting them in config['custom_model_config']!
2025-04-28 14:20:03,299	WARNING algorithm_config.py:2578 -- Setting `exploration_config={}` because you set `_enable_rl_module_api=True`. When RLModule API are enabled, exploration_config can not be set. If you want to implement custom exploration behaviour, please modify the `forward_exploration` method of the RLModule at hand. On configs that have a default exploration config, this must be done with `config.exploration_config={}`.
2025-04-28 14:20:03,301	WARNING deprecation.py:50 -- DeprecationWarning: `ray.rllib.models.torch.torch_modelv2.TorchModelV2` has been deprecated. Use `ray.rllib.core.rl_module.rl_module.RLModule` instead. This will raise an error in the future!
2025-04-28 14:20:03,301	WARNING deprecation.py:50 -- DeprecationWarning: `ray.rllib.models.torch.fcnet.FullyConnectedNetwork` has been deprecated. This will raise an error in the future!
2025-04-28 14:20:03,312	WARNING catalog.py:629 -- Custom ModelV2 should accept all custom options as **kwargs, instead of expecting them in config['custom_model_config']!
[2m[36m(RolloutWorker pid=1305300)[0m 'is_safe_policy' key not found in train batch
[2m[36m(RolloutWorker pid=1305300)[0m 'discriminator_rewards' key not found in train batch
[2m[36m(RolloutWorker pid=1305299)[0m 2025-04-28 14:20:03,255	WARNING deprecation.py:50 -- DeprecationWarning: `ValueNetworkMixin` has been deprecated. This will raise an error in the future!
[2m[36m(RolloutWorker pid=1305299)[0m 2025-04-28 14:20:03,255	WARNING deprecation.py:50 -- DeprecationWarning: `LearningRateSchedule` has been deprecated. This will raise an error in the future!
[2m[36m(RolloutWorker pid=1305299)[0m 2025-04-28 14:20:03,255	WARNING deprecation.py:50 -- DeprecationWarning: `EntropyCoeffSchedule` has been deprecated. This will raise an error in the future!
[2m[36m(RolloutWorker pid=1305299)[0m 2025-04-28 14:20:03,255	WARNING deprecation.py:50 -- DeprecationWarning: `KLCoeffMixin` has been deprecated. This will raise an error in the future!
[2m[36m(RolloutWorker pid=1305299)[0m 2025-04-28 14:20:03,259	WARNING deprecation.py:50 -- DeprecationWarning: `ray.rllib.models.torch.torch_action_dist.TorchDistributionWrapper` has been deprecated. Use `ray.rllib.models.torch.torch_distributions.TorchCategorical` instead. This will raise an error in the future!
2025-04-28 14:20:04,652	WARNING deprecation.py:50 -- DeprecationWarning: `ValueNetworkMixin` has been deprecated. This will raise an error in the future!
2025-04-28 14:20:04,652	WARNING deprecation.py:50 -- DeprecationWarning: `LearningRateSchedule` has been deprecated. This will raise an error in the future!
2025-04-28 14:20:04,652	WARNING deprecation.py:50 -- DeprecationWarning: `EntropyCoeffSchedule` has been deprecated. This will raise an error in the future!
2025-04-28 14:20:04,652	WARNING deprecation.py:50 -- DeprecationWarning: `KLCoeffMixin` has been deprecated. This will raise an error in the future!
/next/u/stephhk/miniconda3/envs/orpo/lib/python3.9/site-packages/torch/nn/modules/linear.py:125: UserWarning: Could not parse CUBLAS_WORKSPACE_CONFIG, using default workspace size of 8519680 bytes. (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:145.)
  return F.linear(input, self.weight, self.bias)
2025-04-28 14:20:04,723	WARNING deprecation.py:50 -- DeprecationWarning: `ray.rllib.models.torch.torch_action_dist.TorchDistributionWrapper` has been deprecated. Use `ray.rllib.models.torch.torch_distributions.TorchCategorical` instead. This will raise an error in the future!
WARNING - occupancy_measures.agents.orpo - 'is_safe_policy' key not found in train batch
WARNING - occupancy_measures.agents.orpo - 'discriminator_rewards' key not found in train batch
2025-04-28 14:20:05,294	WARNING util.py:68 -- Install gputil for GPU system monitoring.
/next/u/stephhk/miniconda3/envs/orpo/lib/python3.9/site-packages/ray/train/_internal/syncer.py:95: UserWarning: `SyncConfig(upload_dir)` is a deprecated configuration and will be ignored. Please remove it from your `SyncConfig`, as this will raise an error in a future version of Ray.
Please specify `train.RunConfig(storage_path)` instead.
  warnings.warn(
/next/u/stephhk/miniconda3/envs/orpo/lib/python3.9/site-packages/ray/train/_internal/syncer.py:95: UserWarning: `SyncConfig(syncer)` is a deprecated configuration and will be ignored. Please remove it from your `SyncConfig`, as this will raise an error in a future version of Ray.
Please implement custom syncing logic with a custom `pyarrow.fs.FileSystem` instead, and pass it into `train.RunConfig(storage_filesystem)`.
  warnings.warn(
INFO - main - Starting training iteration 0
2025-04-28 14:24:46,177	WARNING deprecation.py:50 -- DeprecationWarning: `ray.rllib.execution.train_ops.train_one_step` has been deprecated. This will raise an error in the future!
2025-04-28 14:24:46,180	WARNING deprecation.py:50 -- DeprecationWarning: `_get_slice_indices` has been deprecated. This will raise an error in the future!
/next/u/stephhk/miniconda3/envs/orpo/lib/python3.9/site-packages/torch/autograd/graph.py:824: UserWarning: Could not parse CUBLAS_WORKSPACE_CONFIG, using default workspace size of 8519680 bytes. (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:145.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
INFO - main - Starting training iteration 1
INFO - main - Starting training iteration 2
INFO - main - Starting training iteration 3
INFO - main - Starting training iteration 4
INFO - main - Starting training iteration 5
INFO - main - Starting training iteration 6
INFO - main - Starting training iteration 7
INFO - main - Starting training iteration 8
INFO - main - Starting training iteration 9
INFO - main - Starting training iteration 10
INFO - main - Starting training iteration 11
INFO - main - Starting training iteration 12
INFO - main - Starting training iteration 13
slurmstepd: error: *** JOB 10271272 ON next5 CANCELLED AT 2025-04-28T15:21:13 ***
